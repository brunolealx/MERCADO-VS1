//Bruno Leal
//creativex sistemas
package com.creativex.ui;

import com.creativex.ui.HomeScreen;
import com.creativex.ui.produtos.ProdutoForm;
import com.creativex.ui.estoque.EstoqueForm;
import com.creativex.ui.clientes.ClientesForm;
import com.creativex.ui.fornecedores.FornecedoresForm;
import com.creativex.ui.caixas.CaixaForm;
import com.creativex.ui.ajuda.AjudaForm;
import com.creativex.ui.listagens.ListagensForm;

import javax.swing.*;
import java.awt.*;

/**
 * Janela principal do sistema.
 * - √Årea central para carregar m√≥dulos (JPanel)
 * - Menu inferior com bot√µes
 */
public class MainWindow extends JFrame {

    private final JPanel painelConteudo;
    private final JPanel bottomMenu;

    public MainWindow() {
        setTitle("üìå MERCADO-VS1 ‚Äî Sistema de Gest√£o");
        setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
        setSize(1300, 800);
        setLocationRelativeTo(null);
        setLayout(new BorderLayout());
        setExtendedState(JFrame.MAXIMIZED_BOTH);

        addWindowListener(new java.awt.event.WindowAdapter() {
            @Override
            public void windowClosing(java.awt.event.WindowEvent windowEvent) {
                int response = JOptionPane.showConfirmDialog(MainWindow.this,
                        "Deseja sair do Sistema?", "Confirma√ß√£o",
                        JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE);
                if (response == JOptionPane.YES_OPTION) {
                    System.exit(0);
                }
            }
        });

        // Painel central onde os m√≥dulos ser√£o carregados
        painelConteudo = new JPanel(new BorderLayout());
        add(painelConteudo, BorderLayout.CENTER);

        // Menu inferior
        bottomMenu = criarBottomMenu();
        add(bottomMenu, BorderLayout.SOUTH);
        
        //abrir HomeScreen com o Logo de fundo
        abrirModulo(new HomeScreen());
  
  
        // Carregar tela inicial (home / produtos / dashboard)
        abrirModulo(new ProdutoForm());
    }

    /**
     * Cria o menu inferior com os bot√µes principais (exibidos em 1 ou 2 linhas conforme espa√ßo).
     */
    private JPanel criarBottomMenu() {
        JPanel menu = new JPanel();
        menu.setBorder(BorderFactory.createTitledBorder("Menu principal"));
        menu.setLayout(new FlowLayout(FlowLayout.LEFT, 12, 10));
        menu.setPreferredSize(new Dimension(0, 92));

        JButton btnProdutos     = criarBotaoMenu("Produtos");
        JButton btnEstoque      = criarBotaoMenu("Estoque");
        JButton btnClientes     = criarBotaoMenu("Clientes");
        JButton btnFornecedores = criarBotaoMenu("Fornecedores");
        JButton btnCaixas       = criarBotaoMenu("Caixas");
        JButton btnImpressoras  = criarBotaoMenu("Impressoras");
        JButton btnListagens    = criarBotaoMenu("Listagens");
        JButton btnAjuda        = criarBotaoMenu("Ajuda");
        JButton btnSair         = criarBotaoMenu("Sair do sistema");

        menu.add(btnProdutos);
        menu.add(btnEstoque);
        menu.add(btnClientes);
        menu.add(btnFornecedores);
        menu.add(btnCaixas);
        menu.add(btnImpressoras);
        menu.add(btnListagens);
        menu.add(btnAjuda);
        menu.add(btnSair);

        // A√ß√µes
        btnProdutos.addActionListener(e -> abrirModulo(new ProdutoForm()));
        btnEstoque.addActionListener(e -> abrirModulo(new EstoqueForm()));
        btnClientes.addActionListener(e -> abrirModulo(new ClientesForm()));
        btnFornecedores.addActionListener(e -> abrirModulo(new FornecedoresForm()));
        btnCaixas.addActionListener(e -> abrirModulo(new CaixaForm()));
        btnImpressoras.addActionListener(e ->
                JOptionPane.showMessageDialog(this, "M√≥dulo Impressoras em desenvolvimento"));
        btnListagens.addActionListener(e -> abrirModulo(new ListagensForm()));
        btnAjuda.addActionListener(e -> abrirModulo(new AjudaForm()));
        btnSair.addActionListener(e -> confirmarSaida());

        return menu;
    }

    /**
     * Cria bot√µes com apar√™ncia uniforme para o menu.
     */
    private JButton criarBotaoMenu(String texto) {
        JButton b = new JButton(texto);
        b.setFocusPainted(false);
        b.setFont(new Font("Segoe UI", Font.PLAIN, 13));
        b.setHorizontalAlignment(SwingConstants.CENTER);
        b.setPreferredSize(new Dimension(140, 36));
        return b;
    }

    /**
     * Permite que outros pain√©is (ex.: ListagensForm) pe√ßam que o MainWindow troque o m√≥dulo.
     * Tornado p√∫blico para integra√ß√£o pr√°tica.
     *
     * @param painel JPanel do m√≥dulo a ser exibido
     */
    public void abrirModulo(JPanel painel) {
        painelConteudo.removeAll();
        painelConteudo.add(painel, BorderLayout.CENTER);
        painelConteudo.revalidate();
        painelConteudo.repaint();
    }

    /**
     * Confirma√ß√£o de sa√≠da - chamado pelo bot√£o Sair.
     */
    public void confirmarSaida() {
        int resposta = JOptionPane.showConfirmDialog(
                this,
                "Deseja realmente sair do sistema?",
                "Confirma√ß√£o",
                JOptionPane.YES_NO_OPTION,
                JOptionPane.QUESTION_MESSAGE
        );

        if (resposta == JOptionPane.YES_OPTION) {
            System.exit(0);
        }
    }
}
