
estou continuanto meu projeto MERCADO-VS1 na seguinte estrutura MAVEN.
isso j√° est√° pronto:

src/main/java/com/creativex/

 ‚îú‚îÄ‚îÄ db/
 ‚îÇ    ‚îî‚îÄ‚îÄ Conexao.java
 ‚îú‚îÄ‚îÄ model/
 ‚îÇ    ‚îî‚îÄ‚îÄ Produto.java
 ‚îú‚îÄ‚îÄ dao/
 ‚îÇ    ‚îî‚îÄ‚îÄ ProdutoDAO.java  
 ‚îú‚îÄ‚îÄ ui/
 ‚îÇ    ‚îî‚îÄ‚îÄ ProdutoForm.java
 ‚îî‚îÄ‚îÄ Main.java


==============================================================================



#1 - PRECISO MELHORAR ESTE SISTEMA COM MAIS OP√á√ïES

# CRIAR UM MENU INCLUINDO O QUE J√Å ESTA PRONTO E ACRESCENTAR NOVOS:

-Gest√£o de Estoque: monitoramento de n√≠veis de estoque, alertas de reposi√ß√£o, hist√≥rico de movimenta√ß√µes.
-Caixas : Gerenciar caixas,Registro de vendas, inclus√£o de produtos ao carrinho de compras, c√°lculo de valores
-Gest√£o de Compras: Realiza√ß√£o de pedidos de reposi√ß√£o de estoque, cadastro de fornecedores, controle de entregas e pagamentos.
-Gerenciar clientes
-Gerenciar fornecedores:

poderia ser um menu lateral como:

-Produtos: - j√° est√° pronto
-Estoque : 
-Clientes:
-Fornecedores:
-Caixas  :
-Impressoras:
-Ajuda:


==================================================================================
Isto √© o codigo pronto:

estou continuanto meu projeto MERCADO-VS1 na seguinte estrutura MAVEN.

src/main/java/com/creativix/

 ‚îú‚îÄ‚îÄ db/
 ‚îÇ    ‚îî‚îÄ‚îÄ Conexao.java
 ‚îú‚îÄ‚îÄ model/
 ‚îÇ    ‚îî‚îÄ‚îÄ Produto.java
 ‚îú‚îÄ‚îÄ dao/
 ‚îÇ    ‚îî‚îÄ‚îÄ ProdutoDAO.java  ‚úÖ (este que voc√™ acabou de receber)
 ‚îú‚îÄ‚îÄ ui/
 ‚îÇ    ‚îî‚îÄ‚îÄ ProdutoForm.java
 ‚îî‚îÄ‚îÄ Main.java


==============================================================================
Banco de dados.
CREATE TABLE TABELA_PRODUTOS (
	id INT AUTO_INCREMENT PRIMARY KEY, 
    codigo_barra VARCHAR(20) NOT NULL,
    descricao VARCHAR(50) NOT NULL,
    marca VARCHAR(50),
    atributos VARCHAR(50),
    unidade_medida VARCHAR(30),
    categoria VARCHAR(50),
    cod_grupo SMALLINT UNSIGNED,
    grupo VARCHAR(80),
    tipo_balanca CHAR(1) CHECK (tipo_balanca IN ('B', 'C', 'N')),
    quantidade_estoque DECIMAL(10, 3) NOT NULL DEFAULT 0.000,
    preco_custo DECIMAL(10, 2),
    preco_venda DECIMAL(10, 2) NOT NULL,
    ncm VARCHAR(10),
    cest VARCHAR(7),
    cfop_padrao VARCHAR(4),
    unidade_tributavel VARCHAR(10),
    cean_tributavel VARCHAR(20),
    cst_icms VARCHAR(3),
    aliquota_icms DECIMAL(5, 2) DEFAULT 0.00,
    cst_pis VARCHAR(2),
    ppis DECIMAL(5, 2) DEFAULT 0.00,
    cst_cofins VARCHAR(2),
    pcofins DECIMAL(5, 2) DEFAULT 0.00,
    data_cadastro TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    loja VARCHAR(50) DEFAULT 'Sede',
    UNIQUE INDEX idx_codigo_barra (codigo_barra)
)
ENGINE=InnoDB
DEFAULT CHARSET=utf8mb4
COLLATE=utf8mb4_unicode_ci;



==============================================================================
//Bruno Leal
//creativix sistemas

package com.creativix;
import com.creativix.ui.ProdutoForm;

public class Main {
    public static void main(String[] args) {
        javax.swing.SwingUtilities.invokeLater(() -> new ProdutoForm().setVisible(true));
    }
}


==============================================================================
//Bruno Leal
//creativix sistemas

package com.creativix.model;

import java.math.BigDecimal;
import java.sql.Timestamp;

public class Produto {

    private long id;
    private String codigoBarra;
    private String descricao;
    private String marca;
    private String atributos;
    private String unidadeMedida;
    private String categoria;
    private int codGrupo;
    private String grupo;
    private char tipoBalanca;
    private BigDecimal quantidadeEstoque;
    private BigDecimal precoCusto;
    private BigDecimal precoVenda;

    private String ncm;
    private String cest;
    private String cfopPadrao;
    private String unidadeTributavel;
    private String ceanTributavel;

    private String cstIcms;
    private BigDecimal aliquotaIcms;
    private String cstPis;
    private BigDecimal ppis;
    private String cstCofins;
    private BigDecimal pcofins;

    private Timestamp dataCadastro;
    private String loja;

    // Getters e Setters

    public long getId() { return id; }
    public void setId(long id) { this.id = id; }

    public String getCodigoBarra() { return codigoBarra; }
    public void setCodigoBarra(String codigoBarra) { this.codigoBarra = codigoBarra; }

    public String getDescricao() { return descricao; }
    public void setDescricao(String descricao) { this.descricao = descricao; }

    public String getMarca() { return marca; }
    public void setMarca(String marca) { this.marca = marca; }

    public String getAtributos() { return atributos; }
    public void setAtributos(String atributos) { this.atributos = atributos; }

    public String getUnidadeMedida() { return unidadeMedida; }
    public void setUnidadeMedida(String unidadeMedida) { this.unidadeMedida = unidadeMedida; }

    public String getCategoria() { return categoria; }
    public void setCategoria(String categoria) { this.categoria = categoria; }

    public int getCodGrupo() { return codGrupo; }
    public void setCodGrupo(int codGrupo) { this.codGrupo = codGrupo; }

    public String getGrupo() { return grupo; }
    public void setGrupo(String grupo) { this.grupo = grupo; }

    public char getTipoBalanca() { return tipoBalanca; }
    public void setTipoBalanca(char tipoBalanca) { this.tipoBalanca = tipoBalanca; }

    public BigDecimal getQuantidadeEstoque() { return quantidadeEstoque; }
    public void setQuantidadeEstoque(BigDecimal quantidadeEstoque) { this.quantidadeEstoque = quantidadeEstoque; }

    public BigDecimal getPrecoCusto() { return precoCusto; }
    public void setPrecoCusto(BigDecimal precoCusto) { this.precoCusto = precoCusto; }

    public BigDecimal getPrecoVenda() { return precoVenda; }
    public void setPrecoVenda(BigDecimal precoVenda) { this.precoVenda = precoVenda; }

    public String getNcm() { return ncm; }
    public void setNcm(String ncm) { this.ncm = ncm; }

    public String getCest() { return cest; }
    public void setCest(String cest) { this.cest = cest; }

    public String getCfopPadrao() { return cfopPadrao; }
    public void setCfopPadrao(String cfopPadrao) { this.cfopPadrao = cfopPadrao; }

    public String getUnidadeTributavel() { return unidadeTributavel; }
    public void setUnidadeTributavel(String unidadeTributavel) { this.unidadeTributavel = unidadeTributavel; }

    public String getCeanTributavel() { return ceanTributavel; }
    public void setCeanTributavel(String ceanTributavel) { this.ceanTributavel = ceanTributavel; }

    public String getCstIcms() { return cstIcms; }
    public void setCstIcms(String cstIcms) { this.cstIcms = cstIcms; }

    public BigDecimal getAliquotaIcms() { return aliquotaIcms; }
    public void setAliquotaIcms(BigDecimal aliquotaIcms) { this.aliquotaIcms = aliquotaIcms; }

    public String getCstPis() { return cstPis; }
    public void setCstPis(String cstPis) { this.cstPis = cstPis; }

    public BigDecimal getPpis() { return ppis; }
    public void setPpis(BigDecimal ppis) { this.ppis = ppis; }

    public String getCstCofins() { return cstCofins; }
    public void setCstCofins(String cstCofins) { this.cstCofins = cstCofins; }

    public BigDecimal getPcofins() { return pcofins; }
    public void setPcofins(BigDecimal pcofins) { this.pcofins = pcofins; }

    public Timestamp getDataCadastro() { return dataCadastro; }
    public void setDataCadastro(Timestamp dataCadastro) { this.dataCadastro = dataCadastro; }

    public String getLoja() { return loja; }
    public void setLoja(String loja) { this.loja = loja; }
}

==============================================================================
//Bruno Leal
//creativix sistemas

package com.creativix.dao;
import com.creativix.db.Conexao;
import com.creativix.model.Produto;
import java.sql.*;
import java.util.ArrayList;
import java.util.List;
/**
 * Classe respons√°vel por todas as opera√ß√µes de acesso ao banco de dados
 * relacionadas ao Produto. Implementa o padr√£o DAO, garantindo separa√ß√£o
 * entre regras de neg√≥cio e persist√™ncia.
 * Cont√©m m√©todos para inserir, atualizar, buscar e listar produtos.
 */
public class ProdutoDAO {
    /**
     * Retorna o √∫ltimo produto cadastrado (com maior ID).
     */
    public Produto buscarUltimo() throws SQLException {
        String sql = "SELECT * FROM TABELA_PRODUTOS ORDER BY id DESC LIMIT 1";
        try (Connection conn = Conexao.getConnection();
             PreparedStatement stmt = conn.prepareStatement(sql);
             ResultSet rs = stmt.executeQuery()) {
            if (rs.next()) {
                return mapear(rs);
            }
        }
        return null;
    }

    /**
     * Insere um novo produto no banco de dados.
     *
     * @param p Objeto contendo todos os dados que ser√£o persistidos.
     */
    public void inserir(Produto p) throws SQLException {

        String sql = """
            INSERT INTO TABELA_PRODUTOS (id,
                codigo_barra, descricao, marca, atributos, unidade_medida, categoria,
                cod_grupo, grupo, tipo_balanca, quantidade_estoque, preco_custo, preco_venda,
                ncm, cest, cfop_padrao, unidade_tributavel, cean_tributavel,
                cst_icms, aliquota_icms, cst_pis, ppis, cst_cofins, pcofins, loja
                // data_cadastro tem default CURRENT_TIMESTAMP
            ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
        """;

        try (Connection conn = Conexao.getConnection();
             PreparedStatement stmt = conn.prepareStatement(sql)) {

            stmt.setString(1, p.getCodigoBarra());
            stmt.setString(2, p.getDescricao());
            stmt.setString(3, p.getMarca());
            stmt.setString(4, p.getAtributos());
            stmt.setString(5, p.getUnidadeMedida());
            stmt.setString(6, p.getCategoria());
            stmt.setInt(7, p.getCodGrupo());
            stmt.setString(8, p.getGrupo());
            stmt.setString(9, String.valueOf(p.getTipoBalanca()));
            stmt.setBigDecimal(10, p.getQuantidadeEstoque());
            stmt.setBigDecimal(11, p.getPrecoCusto());
            stmt.setBigDecimal(12, p.getPrecoVenda());
            stmt.setString(13, p.getNcm());
            stmt.setString(14, p.getCest());
            stmt.setString(15, p.getCfopPadrao());
            stmt.setString(16, p.getUnidadeTributavel());
            stmt.setString(17, p.getCeanTributavel());
            stmt.setString(18, p.getCstIcms());
            stmt.setBigDecimal(19, p.getAliquotaIcms());
            stmt.setString(20, p.getCstPis());
            stmt.setBigDecimal(21, p.getPpis());
            stmt.setString(22, p.getCstCofins());
            stmt.setBigDecimal(23, p.getPcofins());
            stmt.setString(24, p.getLoja());

            stmt.executeUpdate();
        }
    }

    /**
     * Atualiza um produto existente com base no ID.
     * @param p Produto contendo os novos dados.
     */
    public void atualizar(Produto p) throws SQLException {
        String sql = """
            UPDATE TABELA_PRODUTOS SET
                id=?, codigo_barra = ?, descricao = ?, marca = ?, atributos = ?, unidade_medida = ?,
                categoria = ?, cod_grupo = ?, grupo = ?, tipo_balanca = ?,
                quantidade_estoque = ?, preco_custo = ?, preco_venda = ?,
                ncm = ?, cest = ?, cfop_padrao = ?, unidade_tributavel = ?, cean_tributavel = ?,
                cst_icms = ?, aliquota_icms = ?, cst_pis = ?, ppis = ?,
                cst_cofins = ?, pcofins = ?, loja = ?
            WHERE id = ?
        """;

        try (Connection conn = Conexao.getConnection();
             PreparedStatement stmt = conn.prepareStatement(sql)) {

            stmt.setString(1, p.getCodigoBarra());
            stmt.setString(2, p.getDescricao());
            stmt.setString(3, p.getMarca());
            stmt.setString(4, p.getAtributos());
            stmt.setString(5, p.getUnidadeMedida());
            stmt.setString(6, p.getCategoria());
            stmt.setInt(7, p.getCodGrupo());
            stmt.setString(8, p.getGrupo());
            stmt.setString(9, String.valueOf(p.getTipoBalanca()));
            stmt.setBigDecimal(10, p.getQuantidadeEstoque());
            stmt.setBigDecimal(11, p.getPrecoCusto());
            stmt.setBigDecimal(12, p.getPrecoVenda());
            stmt.setString(13, p.getNcm());
            stmt.setString(14, p.getCest());
            stmt.setString(15, p.getCfopPadrao());
            stmt.setString(16, p.getUnidadeTributavel());
            stmt.setString(17, p.getCeanTributavel());
            stmt.setString(18, p.getCstIcms());
            stmt.setBigDecimal(19, p.getAliquotaIcms());
            stmt.setString(20, p.getCstPis());
            stmt.setBigDecimal(21, p.getPpis());
            stmt.setString(22, p.getCstCofins());
            stmt.setBigDecimal(23, p.getPcofins());
            stmt.setString(24, p.getLoja());
            stmt.setLong(25, p.getId()); // WHERE id = ?

            stmt.executeUpdate();
        }
    }

    /**
     * Busca um produto por ID.
     *
     * @param id Identificador do produto.
     * @return Produto encontrado ou null se inexistente.
     */
    public Produto buscarPorId(long id) throws SQLException {
        String sql = "SELECT * FROM TABELA_PRODUTOS WHERE id = ?";
        try (Connection conn = Conexao.getConnection();
             PreparedStatement stmt = conn.prepareStatement(sql)) {
            stmt.setLong(1, id);
            try (ResultSet rs = stmt.executeQuery()) {
                if (rs.next()) {
                    return mapear(rs);
                }
            }
        }
        return null;
    }

    /**
     * Busca produtos por parte da descri√ß√£o.
     *
     * @param nome parcial a ser pesquisado.
     * @return Lista de produtos encontrados.
     */
    public Produto buscarPorNome(String nome) throws SQLException {
        // Alterado de id_Produto para descricao
        String sql = "SELECT * FROM TABELA_PRODUTOS WHERE descricao LIKE ?";
        try (Connection conn = Conexao.getConnection();
             PreparedStatement stmt = conn.prepareStatement(sql)) {
            stmt.setString(1, "%" + nome + "%");
            try (ResultSet rs = stmt.executeQuery()) {
                if (rs.next()) {
                    return mapear(rs);
                }
            }
        }
        return null;
    }

    // ==============================
    // LISTAR TODOS
    // ==============================
    public List<Produto> listarTodos() throws SQLException {
        String sql = "SELECT * FROM TABELA_PRODUTOS WHERE id > 0";
        List<Produto> lista = new ArrayList<>();

        try (Connection conn = Conexao.getConnection();
             PreparedStatement stmt = conn.prepareStatement(sql);
             ResultSet rs = stmt.executeQuery()) {

            while (rs.next()) {
                lista.add(mapear(rs));
            }
        }
        return lista;
    }

    // ==============================
    // CONVERSOR DE RESULTSET ‚Üí PRODUTO
    // ==============================
    private Produto mapear(ResultSet rs) throws SQLException {
        Produto p = new Produto();
        p.setId(rs.getLong("id"));
        p.setCodigoBarra(rs.getString("codigo_barra"));
        p.setDescricao(rs.getString("descricao"));
        p.setMarca(rs.getString("marca"));
        p.setAtributos(rs.getString("atributos"));
        p.setUnidadeMedida(rs.getString("unidade_medida"));
        p.setCategoria(rs.getString("categoria"));
        p.setCodGrupo(rs.getInt("cod_grupo"));
        p.setGrupo(rs.getString("grupo"));

        // Trata char (pode ser null)
        String tipoBalanca = rs.getString("tipo_balanca");
        if (tipoBalanca != null && !tipoBalanca.isEmpty()) {
            p.setTipoBalanca(tipoBalanca.charAt(0));
        }

        p.setQuantidadeEstoque(rs.getBigDecimal("quantidade_estoque"));
        p.setPrecoCusto(rs.getBigDecimal("preco_custo"));
        p.setPrecoVenda(rs.getBigDecimal("preco_venda"));

        p.setNcm(rs.getString("ncm"));
        p.setCest(rs.getString("cest"));
        p.setCfopPadrao(rs.getString("cfop_padrao"));
        p.setUnidadeTributavel(rs.getString("unidade_tributavel"));
        p.setCeanTributavel(rs.getString("cean_tributavel"));

        p.setCstIcms(rs.getString("cst_icms"));
        p.setAliquotaIcms(rs.getBigDecimal("aliquota_icms"));

        p.setCstPis(rs.getString("cst_pis"));
        p.setPpis(rs.getBigDecimal("ppis"));

        p.setCstCofins(rs.getString("cst_cofins"));
        p.setPcofins(rs.getBigDecimal("pcofins"));

        p.setDataCadastro(rs.getTimestamp("data_cadastro"));
        p.setLoja(rs.getString("loja"));

        return p;
    }
==============================================================================

package com.creativix.ui;

import com.creativix.dao.ProdutoDAO;
import com.creativix.model.Produto;

import javax.swing.*;
import javax.swing.table.DefaultTableModel;
import java.awt.*;
import java.awt.event.*;
import java.math.BigDecimal;
import java.sql.SQLException;
import java.util.List;
/**
 * Janela principal de cadastro de produtos.
 *
 * Respons√°vel por:
 * - Cadastro e altera√ß√£o de produtos
 * - Busca por ID
 * - Busca por descri√ß√£o
 * - Listagem geral
 * - Preenchimento da tabela
 *
 * Este formul√°rio utiliza ProdutoDAO para executar opera√ß√µes
 * de banco de dados e exibe/edita informa√ß√µes na interface.
 */
public class ProdutoForm extends JFrame {

    private JTextField txtId, txtCodigoBarra, txtDescricao, txtMarca, txtAtributos, txtUnidadeMedida,
            txtCategoria, txtCodGrupo, txtGrupo, txtTipoBalanca, txtQuantidadeEstoque,
            txtPrecoCusto, txtPrecoVenda, txtNcm, txtCest, txtCfopPadrao,
            txtUnidadeTributavel, txtCeanTributavel, txtCstIcms, txtAliquotaIcms,
            txtCstPis, txtPpis, txtCstCofins, txtPcofins, txtLoja;

    private JTable table;
    private DefaultTableModel model;
    private ProdutoDAO dao;

    public ProdutoForm() {
        dao = new ProdutoDAO();
        setTitle("üì¶ Gerenciamento de Produtos - ESTOQUE");
        setSize(1200, 800);
        setLocationRelativeTo(null);
        setExtendedState(JFrame.MAXIMIZED_BOTH);
        setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
        setLayout(new BorderLayout());

        /** sa√≠da do sistema  e fechamento da janela
         *
         */
        setExtendedState(JFrame.MAXIMIZED_BOTH);
        setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);

        addWindowListener(new java.awt.event.WindowAdapter() {
            @Override
            public void windowClosing(java.awt.event.WindowEvent windowEvent) {
                int response = JOptionPane.showConfirmDialog(null,
                        "Deseja sair do Sistema?", "Confirma√ß√£o",
                        JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE);
                if (response == JOptionPane.YES_OPTION) {
                    System.exit(0);
                }
            }
        });

       addWindowListener(new WindowAdapter() {
            @Override
            public void windowClosing(WindowEvent e) {
                int resp = JOptionPane.showConfirmDialog(null, "Deseja sair do sistema?", "Confirma√ß√£o",
                        JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE);
                if (resp == JOptionPane.YES_OPTION) System.exit(0);
            }
        });

        // ============= ABAS =============
        JTabbedPane abas = new JTabbedPane();
        abas.addTab("Dados do Produto", criarPainelDadosProduto());
        abas.addTab("Dados Fiscais", criarPainelDadosFiscais());
        add(abas, BorderLayout.NORTH);

        // ============= TABELA =============
        model = new DefaultTableModel(new String[]{
                "ID", "C√≥digo Barra", "Descri√ß√£o", "Categoria", "Qtd", "Pre√ßo Venda (R$)"
        }, 0);
        table = new JTable(model);
        add(new JScrollPane(table), BorderLayout.CENTER);

        // ============= BOT√ïES =============
        JPanel pnlBotoes = new JPanel();
        pnlBotoes.setBorder(BorderFactory.createTitledBorder("Op√ß√µes"));

        JButton btnNovo = new JButton("Novo");
        JButton btnSalvar = new JButton("Salvar");
        JButton btnAtualizar = new JButton("Atualizar");
        JButton btnListar = new JButton("Listar Todos");
        JButton btnBuscar = new JButton("Buscar");

        pnlBotoes.add(btnNovo);
        pnlBotoes.add(btnSalvar);
        pnlBotoes.add(btnAtualizar);
        pnlBotoes.add(btnListar);
        pnlBotoes.add(btnBuscar);
        add(pnlBotoes, BorderLayout.SOUTH);

        // ============= EVENTOS =============
        btnNovo.addActionListener(e -> limparCampos());
        btnSalvar.addActionListener(e -> salvarProduto());
        btnAtualizar.addActionListener(e -> atualizarProduto());
        btnListar.addActionListener(e -> listarProdutos());
        btnBuscar.addActionListener(e -> buscarProduto());

        table.addMouseListener(new MouseAdapter() {
            public void mouseClicked(MouseEvent e) {
                int row = table.getSelectedRow();
                if (row != -1) {
                    txtId.setText(model.getValueAt(row, 0).toString());
                    txtCodigoBarra.setText(model.getValueAt(row, 1).toString());
                    txtDescricao.setText(model.getValueAt(row, 2).toString());
                    txtCategoria.setText(model.getValueAt(row, 3).toString());
                    txtQuantidadeEstoque.setText(model.getValueAt(row, 4).toString());
                    txtPrecoVenda.setText(model.getValueAt(row, 5).toString());
                }
            }
        });

        produtoFinal();
    }

    // =====================================================
    // PAINEL: DADOS DO PRODUTO
    // =====================================================
    private JPanel criarPainelDadosProduto() {
        JPanel p = new JPanel(new GridLayout(13, 2, 5, 5));
        p.setBorder(BorderFactory.createTitledBorder("Dados Operacionais"));

        txtId = new JTextField();               adicionarCampo(p, "ID:", txtId);
        txtCodigoBarra = new JTextField();      adicionarCampo(p, "C√≥digo de Barras:", txtCodigoBarra);
        txtDescricao = new JTextField();        adicionarCampo(p, "Descri√ß√£o:", txtDescricao);
        txtMarca = new JTextField();            adicionarCampo(p, "Marca:", txtMarca);
        txtAtributos = new JTextField();        adicionarCampo(p, "Atributos:", txtAtributos);
        txtUnidadeMedida = new JTextField();    adicionarCampo(p, "Unidade de Medida:", txtUnidadeMedida);
        txtCategoria = new JTextField();        adicionarCampo(p, "Categoria:", txtCategoria);
        txtCodGrupo = new JTextField();         adicionarCampo(p, "C√≥digo do Grupo:", txtCodGrupo);
        txtGrupo = new JTextField();            adicionarCampo(p, "Grupo:", txtGrupo);
        txtTipoBalanca = new JTextField();      adicionarCampo(p, "Tipo Balan√ßa (B/C/N):", txtTipoBalanca);
        txtQuantidadeEstoque = new JTextField();adicionarCampo(p, "Quantidade Estoque:", txtQuantidadeEstoque);
        txtPrecoCusto = new JTextField();       adicionarCampo(p, "Pre√ßo Custo (R$):", txtPrecoCusto);
        txtPrecoVenda = new JTextField();       adicionarCampo(p, "Pre√ßo Venda (R$):", txtPrecoVenda);

        return p;
    }

    // =====================================================
    // PAINEL: DADOS FISCAIS
    // =====================================================
    private JPanel criarPainelDadosFiscais() {
        JPanel p = new JPanel(new GridLayout(12, 2, 5, 5));
        p.setBorder(BorderFactory.createTitledBorder("Dados Fiscais e Tribut√°rios"));

        txtNcm = new JTextField();              adicionarCampo(p, "NCM:", txtNcm);
        txtCest = new JTextField();             adicionarCampo(p, "CEST:", txtCest);
        txtCfopPadrao = new JTextField();       adicionarCampo(p, "CFOP Padr√£o:", txtCfopPadrao);
        txtUnidadeTributavel = new JTextField();adicionarCampo(p, "Unidade Tribut√°vel:", txtUnidadeTributavel);
        txtCeanTributavel = new JTextField();   adicionarCampo(p, "CEAN Tribut√°vel:", txtCeanTributavel);
        txtCstIcms = new JTextField();          adicionarCampo(p, "CST ICMS:", txtCstIcms);
        txtAliquotaIcms = new JTextField();     adicionarCampo(p, "Al√≠quota ICMS (%):", txtAliquotaIcms);
        txtCstPis = new JTextField();           adicionarCampo(p, "CST PIS:", txtCstPis);
        txtPpis = new JTextField();             adicionarCampo(p, "PIS (%):", txtPpis);
        txtCstCofins = new JTextField();        adicionarCampo(p, "CST COFINS:", txtCstCofins);
        txtPcofins = new JTextField();          adicionarCampo(p, "COFINS (%):", txtPcofins);
        txtLoja = new JTextField("Sede");       adicionarCampo(p, "Loja:", txtLoja);

        return p;
    }

    private void adicionarCampo(JPanel p, String label, JTextField campo) {
        p.add(new JLabel(label));
        p.add(campo);
    }

    // =====================================================
    // OPERA√á√ïES CRUD
    // =====================================================
    private void produtoFinal() {
        try {
            Produto p = dao.buscarUltimo();
            if (p != null) preencherCampos(p);
        } catch (Exception ex) {
            JOptionPane.showMessageDialog(this, "Erro ao ler √∫ltimo registro: " + ex.getMessage());
        }
    }

    private void salvarProduto() {
        try {
            Produto p = criarProdutoDeCampos();
            dao.inserir(p);
            JOptionPane.showMessageDialog(this, "Produto salvo com sucesso!");
            listarProdutos();
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "Erro ao salvar: " + e.getMessage());
        }
    }

    private void atualizarProduto() {
        if (txtId.getText().isEmpty()) {
            JOptionPane.showMessageDialog(this, "Selecione um produto para atualizar!");
            return;
        }
        try {
            Produto p = criarProdutoDeCampos();
            p.setId(Long.parseLong(txtId.getText()));
            dao.atualizar(p);
            JOptionPane.showMessageDialog(this, "Produto atualizado com sucesso!");
            listarProdutos();
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "Erro ao atualizar: " + e.getMessage());
        }
    }

    private void listarProdutos() {
        try {
            model.setRowCount(0);
            List<Produto> produtos = dao.listarTodos();
            for (Produto p : produtos) {
                model.addRow(new Object[]{
                        p.getId(),
                        p.getCodigoBarra(),
                        p.getDescricao(),
                        p.getCategoria(),
                        p.getQuantidadeEstoque(),
                        p.getPrecoVenda()
                });
            }
        } catch (SQLException e) {
            JOptionPane.showMessageDialog(this, "Erro ao listar: " + e.getMessage());
        }
    }

    private void buscarProduto() {
        String entrada = JOptionPane.showInputDialog(this, "Digite o ID ou descri√ß√£o:");
        if (entrada == null || entrada.isBlank()) return;

        try {
            Produto p = entrada.matches("\\d+") ?
                    dao.buscarPorId(Long.parseLong(entrada)) :
                    dao.buscarPorNome(entrada);

            if (p != null) {
                preencherCampos(p);
                JOptionPane.showMessageDialog(this, "Produto encontrado!");
            } else {
                JOptionPane.showMessageDialog(this, "Produto n√£o encontrado.");
            }
        } catch (SQLException e) {
            JOptionPane.showMessageDialog(this, "Erro na busca: " + e.getMessage());
        }
    }

    // =====================================================
    // UTILIT√ÅRIOS
    // =====================================================
    private Produto criarProdutoDeCampos() {
        Produto p = new Produto();
        p.setCodigoBarra(txtCodigoBarra.getText());
        p.setDescricao(txtDescricao.getText());
        p.setMarca(txtMarca.getText());
        p.setAtributos(txtAtributos.getText());
        p.setUnidadeMedida(txtUnidadeMedida.getText());
        p.setCategoria(txtCategoria.getText());
        p.setCodGrupo(parseInt(txtCodGrupo.getText()));
        p.setGrupo(txtGrupo.getText());
        p.setTipoBalanca(getChar(txtTipoBalanca.getText()));
        p.setQuantidadeEstoque(parseBig(txtQuantidadeEstoque.getText()));
        p.setPrecoCusto(parseBig(txtPrecoCusto.getText()));
        p.setPrecoVenda(parseBig(txtPrecoVenda.getText()));
        p.setNcm(txtNcm.getText());
        p.setCest(txtCest.getText());
        p.setCfopPadrao(txtCfopPadrao.getText());
        p.setUnidadeTributavel(txtUnidadeTributavel.getText());
        p.setCeanTributavel(txtCeanTributavel.getText());
        p.setCstIcms(txtCstIcms.getText());
        p.setAliquotaIcms(parseBig(txtAliquotaIcms.getText()));
        p.setCstPis(txtCstPis.getText());
        p.setPpis(parseBig(txtPpis.getText()));
        p.setCstCofins(txtCstCofins.getText());
        p.setPcofins(parseBig(txtPcofins.getText()));
        p.setLoja(txtLoja.getText());
        return p;
    }

    private void preencherCampos(Produto p) {
        txtId.setText(String.valueOf(p.getId()));
        txtCodigoBarra.setText(p.getCodigoBarra());
        txtDescricao.setText(p.getDescricao());
        txtMarca.setText(p.getMarca());
        txtAtributos.setText(p.getAtributos());
        txtUnidadeMedida.setText(p.getUnidadeMedida());
        txtCategoria.setText(p.getCategoria());
        txtCodGrupo.setText(String.valueOf(p.getCodGrupo()));
        txtGrupo.setText(p.getGrupo());
        txtTipoBalanca.setText(String.valueOf(p.getTipoBalanca()));
        txtQuantidadeEstoque.setText(String.valueOf(p.getQuantidadeEstoque()));
        txtPrecoCusto.setText(String.valueOf(p.getPrecoCusto()));
        txtPrecoVenda.setText(String.valueOf(p.getPrecoVenda()));
        txtNcm.setText(p.getNcm());
        txtCest.setText(p.getCest());
        txtCfopPadrao.setText(p.getCfopPadrao());
        txtUnidadeTributavel.setText(p.getUnidadeTributavel());
        txtCeanTributavel.setText(p.getCeanTributavel());
        txtCstIcms.setText(p.getCstIcms());
        txtAliquotaIcms.setText(String.valueOf(p.getAliquotaIcms()));
        txtCstPis.setText(p.getCstPis());
        txtPpis.setText(String.valueOf(p.getPpis()));
        txtCstCofins.setText(p.getCstCofins());
        txtPcofins.setText(String.valueOf(p.getPcofins()));
        txtLoja.setText(p.getLoja());
    }

    private void limparCampos() {
        for (Component c : getComponents()) {
            if (c instanceof JTextField) ((JTextField) c).setText("");
        }
    }

    private BigDecimal parseBig(String s) {
        try { return new BigDecimal(s.trim()); } catch (Exception e) { return BigDecimal.ZERO; }
    }

    private int parseInt(String s) {
        try { return Integer.parseInt(s.trim()); } catch (Exception e) { return 0; }
    }

    private char getChar(String s) {
        return (s != null && !s.isBlank()) ? s.trim().charAt(0) : 'N';
    }
}

==============================================================================

